# Tide

[![Python](https://img.shields.io/badge/Python-3.9+-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

Tide æ˜¯ä¸€ä¸ªåŸºäº [Peek](https://github.com/kaydxh/peek) åŸºç¡€åº“çš„ Python Web/gRPC æœåŠ¡æ¡†æ¶ï¼Œå‚è€ƒ [Sea](https://github.com/kaydxh/sea) (Goç‰ˆæœ¬) çš„æ¶æ„è®¾è®¡ã€‚

## ç‰¹æ€§

- ğŸš€ **åŒåè®®æ”¯æŒ**: åŒæ—¶æ”¯æŒ HTTP (FastAPI) å’Œ gRPC
- ğŸ—ï¸ **DDD æ¶æ„**: é‡‡ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡åˆ†å±‚æ¶æ„
- ğŸ”Œ **æ’ä»¶åŒ–**: ç»„ä»¶æ’ä»¶åŒ–ï¼ŒæŒ‰éœ€åŠ è½½
- âš™ï¸ **é…ç½®é©±åŠ¨**: YAML é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
- ğŸ“Š **å¯è§‚æµ‹æ€§**: é›†æˆ OpenTelemetry (Trace/Metric/Log)
- ğŸ›¡ï¸ **ä¼ä¸šçº§ç‰¹æ€§**: é™æµã€ç†”æ–­ã€æœåŠ¡å‘ç°ç­‰

## å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
pip install tide

# æˆ–è€…å®‰è£…å®Œæ•´ä¾èµ–
pip install tide[all]
```

### åˆ›å»ºé¡¹ç›®

```bash
# ä½¿ç”¨ CLI åˆ›å»ºæ–°é¡¹ç›®
tide new my-service

# æˆ–è€…æ‰‹åŠ¨åˆ›å»º
mkdir my-service && cd my-service
tide init
```

### é¡¹ç›®ç»“æ„

```
my-service/
â”œâ”€â”€ api/                    # Proto/API å®šä¹‰
â”‚   â””â”€â”€ my_service/v1/
â”œâ”€â”€ cmd/                    # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ my_service/
â”‚       â”œâ”€â”€ main.py
â”‚       â””â”€â”€ app/
â”‚           â”œâ”€â”€ server.py
â”‚           â””â”€â”€ plugins/
â”œâ”€â”€ pkg/                    # ä¸šåŠ¡é€»è¾‘ (DDD)
â”‚   â””â”€â”€ my_service/
â”‚       â”œâ”€â”€ application/    # åº”ç”¨å±‚
â”‚       â”œâ”€â”€ domain/         # é¢†åŸŸå±‚
â”‚       â”œâ”€â”€ infrastructure/ # åŸºç¡€è®¾æ–½å±‚
â”‚       â””â”€â”€ provider/       # ä¾èµ–æ³¨å…¥
â”œâ”€â”€ web/                    # Web æ§åˆ¶å™¨
â”œâ”€â”€ conf/                   # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config.yaml
â”œâ”€â”€ tests/
â””â”€â”€ pyproject.toml
```

### ç¤ºä¾‹ä»£ç 

```python
from tide import TideApp, Command
from tide.config import load_config

# åˆ›å»ºåº”ç”¨
app = TideApp(name="my-service")

# æ³¨å†Œå‘½ä»¤
@app.command()
def serve(config: str = "conf/config.yaml"):
    """å¯åŠ¨æœåŠ¡"""
    cfg = load_config(config)
    app.run(cfg)

if __name__ == "__main__":
    app.cli()
```

## é…ç½®ç¤ºä¾‹

```yaml
# conf/config.yaml
log:
  level: info
  format: json

web:
  bind_address:
    host: "0.0.0.0"
    port: 8080
  grpc:
    enabled: true
    port: 50051
  http:
    enabled: true

database:
  mysql:
    enabled: false
    host: localhost
    port: 3306
  redis:
    enabled: false
    host: localhost
    port: 6379

open_telemetry:
  enabled: true
  service_name: my-service
```

## DDD åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Web Layer (Controller)                â”‚
â”‚                  HTTP/gRPC è¯·æ±‚å¤„ç†                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Application Layer                      â”‚
â”‚              ç”¨ä¾‹ç¼–æ’ã€å‘½ä»¤/æŸ¥è¯¢å¤„ç†                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Domain Layer                         â”‚
â”‚           å®ä½“ã€å€¼å¯¹è±¡ã€é¢†åŸŸæœåŠ¡ã€Repositoryæ¥å£          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Infrastructure Layer                    â”‚
â”‚            Repositoryå®ç°ã€å¤–éƒ¨æœåŠ¡é€‚é…å™¨                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä¾èµ–

- [Peek](https://github.com/kaydxh/peek) - Python åŸºç¡€åº“
- [FastAPI](https://fastapi.tiangolo.com/) - HTTP æ¡†æ¶
- [gRPC](https://grpc.io/) - RPC æ¡†æ¶
- [Pydantic](https://pydantic.dev/) - æ•°æ®éªŒè¯
- [OpenTelemetry](https://opentelemetry.io/) - å¯è§‚æµ‹æ€§

## License

MIT License
